import{r as f,l as y,e as u,i as p,f as e,K as P,h as g,L as l,M as n,H as h,j as R,S as x,F as V,u as k,o as c}from"./vendor-CVqOb0XR.js";import{c as C}from"./customers-Cmme__ly.js";import{_ as S,o as U,a as b,l as i}from"./index-Ba6kPx5P.js";import{C as q,a as G}from"./CommonFooter-B2JgU46h.js";import"./ui-D_DTyfBr.js";const I={class:"registration-page"},N={class:"container mt-5"},E={class:"row justify-content-center"},F={class:"col-md-8 col-lg-6"},B={class:"card shadow"},M={class:"card-body"},j={class:"row"},A={class:"col-md-6 mb-3"},D={class:"col-md-6 mb-3"},H={class:"row"},L={class:"col-md-6 mb-3"},T={class:"col-md-6 mb-3"},K={class:"mb-3"},O={class:"mb-3"},z={class:"mb-3"},J={key:0,class:"alert alert-danger"},Q={class:"d-grid"},W=["disabled"],X={key:0,class:"spinner-border spinner-border-sm me-2"},Y={class:"mt-3 text-center"},Z={__name:"CustomerRegister",setup($){const m=k(),d=f(!1),a=f(""),o=y({first_name:"",last_name:"",email:"",phone:"",address:"",password:"",confirmPassword:"",preferred_language:"en",push_enabled:!0}),v=async()=>{if(a.value="",o.password!==o.confirmPassword){a.value="Passwords do not match";return}if(o.password.length<6){a.value="Password must be at least 6 characters long";return}d.value=!0;try{if((await C.register({first_name:o.first_name,last_name:o.last_name,email:o.email,phone:o.phone,address:o.address,password:o.password})).data.message)try{const s=await b.post("/api/token/",{username:o.email,password:o.password});localStorage.setItem("access_token",s.data.access),localStorage.setItem("refresh_token",s.data.refresh),i.success("Registration and login successful!"),m.push("/customer-portal")}catch{i.success("Registration successful! Please log in."),m.push("/customer-portal/login")}}catch(t){a.value=t.response?.data?.error||"Registration failed. Please try again.",i.error(a.value)}finally{d.value=!1}},w=async t=>{try{const s=await b.post("/api/google-login/",{credential:t.credential});localStorage.setItem("access_token",s.data.access),localStorage.setItem("refresh_token",s.data.refresh),i.success("Google sign-in successful! Redirecting to dashboard..."),m.push("/customer-portal")}catch(s){console.error("Google sign-up error:",s),i.error("Google sign-in failed. Please try again.")}},_=t=>{console.error("Google sign-up error:",t),i.error("Google sign-up failed.")};return(t,s)=>(c(),u(V,null,[p(q),s[17]||(s[17]=e("br",null,null,-1)),s[18]||(s[18]=e("br",null,null,-1)),s[19]||(s[19]=e("br",null,null,-1)),e("div",I,[e("div",N,[e("div",E,[e("div",F,[e("div",B,[s[16]||(s[16]=e("div",{class:"card-header bg-primary text-white"},[e("h4",{class:"mb-0"},"Customer Registration")],-1)),e("div",M,[e("form",{onSubmit:P(v,["prevent"])},[e("div",j,[e("div",A,[s[7]||(s[7]=e("label",{for:"first_name",class:"form-label"},"First Name *",-1)),l(e("input",{type:"text",class:"form-control",id:"first_name","onUpdate:modelValue":s[0]||(s[0]=r=>o.first_name=r),required:""},null,512),[[n,o.first_name]])]),e("div",D,[s[8]||(s[8]=e("label",{for:"last_name",class:"form-label"},"Last Name *",-1)),l(e("input",{type:"text",class:"form-control",id:"last_name","onUpdate:modelValue":s[1]||(s[1]=r=>o.last_name=r),required:""},null,512),[[n,o.last_name]])])]),e("div",H,[e("div",L,[s[9]||(s[9]=e("label",{for:"email",class:"form-label"},"Email *",-1)),l(e("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":s[2]||(s[2]=r=>o.email=r),required:""},null,512),[[n,o.email]])]),e("div",T,[s[10]||(s[10]=e("label",{for:"phone",class:"form-label"},"Phone *",-1)),l(e("input",{type:"tel",class:"form-control",id:"phone","onUpdate:modelValue":s[3]||(s[3]=r=>o.phone=r),required:""},null,512),[[n,o.phone]])])]),e("div",K,[s[11]||(s[11]=e("label",{for:"address",class:"form-label"},"Address *",-1)),l(e("textarea",{class:"form-control",id:"address",rows:"3","onUpdate:modelValue":s[4]||(s[4]=r=>o.address=r),required:""},null,512),[[n,o.address]])]),e("div",O,[s[12]||(s[12]=e("label",{for:"password",class:"form-label"},"Password *",-1)),l(e("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":s[5]||(s[5]=r=>o.password=r),required:""},null,512),[[n,o.password]])]),e("div",z,[s[13]||(s[13]=e("label",{for:"confirmPassword",class:"form-label"},"Confirm Password *",-1)),l(e("input",{type:"password",class:"form-control",id:"confirmPassword","onUpdate:modelValue":s[6]||(s[6]=r=>o.confirmPassword=r),required:""},null,512),[[n,o.confirmPassword]])]),a.value?(c(),u("div",J,h(a.value),1)):g("",!0),e("div",Q,[e("button",{type:"submit",class:"btn btn-primary",disabled:d.value},[d.value?(c(),u("span",X)):g("",!0),s[14]||(s[14]=R(" Register as Customer ",-1))],8,W)])],32),e("div",Y,[s[15]||(s[15]=e("p",null,"Or",-1)),p(x(U),{onSuccess:w,onError:_})])])])])]),p(G)])])],64))}},ts=S(Z,[["__scopeId","data-v-1c460575"]]);export{ts as default};
