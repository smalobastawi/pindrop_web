import{_,a as p}from"./index-Ba6kPx5P.js";import{e as a,f as s,h as u,H as t,J as v,F as g,I as c,o as n,j as o}from"./vendor-CVqOb0XR.js";import"./ui-D_DTyfBr.js";const m={name:"RiderPortal",data(){return{rider:null,deliveries:[],stats:{},loading:!0,error:null}},mounted(){this.fetchData()},methods:{formatCurrency(r){return new Intl.NumberFormat("en-US",{style:"currency",currency:"KES"}).format(r)},async fetchData(){try{const r=localStorage.getItem("access_token"),e=await p.get("/api/rider/portal/",{headers:{Authorization:`Bearer ${r}`}});this.rider=e.data.rider,this.deliveries=e.data.deliveries,this.stats=e.data.stats}catch(r){this.error="Failed to load rider data",console.error(r)}finally{this.loading=!1}},async toggleAvailability(){try{const r=localStorage.getItem("access_token"),e=await p.post("/api/mobile/rider/availability/",{is_available:!this.rider.is_available},{headers:{Authorization:`Bearer ${r}`}});this.rider.is_available=e.data.is_available,this.stats.is_available=e.data.is_available}catch(r){alert("Failed to update availability"),console.error(r)}}}},y={class:"rider-portal"},b={class:"container"},f={key:0,class:"loading"},h={key:1,class:"error"},k={key:2},D={class:"stats-grid"},A={class:"stat-card"},C={class:"stat-card"},F={class:"stat-card"},I={class:"stat-card"},S={class:"stat-card"},x={class:"stat-card"},B={class:"stat-card"},P={class:"availability-section"},R={class:"deliveries-section"},E={key:0,class:"no-deliveries"},N={key:1,class:"deliveries-list"},O={class:"delivery-header"},T={class:"delivery-details"},w={key:0};function z(r,e,V,G,i,d){return n(),a("div",y,[s("div",b,[e[17]||(e[17]=s("h1",null,"Rider Portal",-1)),i.loading?(n(),a("div",f,"Loading...")):u("",!0),i.error?(n(),a("div",h,t(i.error),1)):u("",!0),!i.loading&&!i.error?(n(),a("div",k,[s("div",D,[s("div",A,[e[1]||(e[1]=s("h3",null,"Total Deliveries",-1)),s("p",null,t(i.stats.total_deliveries),1)]),s("div",C,[e[2]||(e[2]=s("h3",null,"Pending Deliveries",-1)),s("p",null,t(i.stats.pending_deliveries),1)]),s("div",F,[e[3]||(e[3]=s("h3",null,"In Transit",-1)),s("p",null,t(i.stats.in_transit),1)]),s("div",I,[e[4]||(e[4]=s("h3",null,"Completed Deliveries",-1)),s("p",null,t(i.stats.completed_deliveries),1)]),s("div",S,[e[5]||(e[5]=s("h3",null,"Total Earnings",-1)),s("p",null,t(d.formatCurrency(i.stats.total_earnings)),1)]),s("div",x,[e[6]||(e[6]=s("h3",null,"Rating",-1)),s("p",null,t(i.stats.rating)+"/5",1)]),s("div",B,[e[7]||(e[7]=s("h3",null,"Availability",-1)),s("p",{class:v(i.stats.is_available?"available":"unavailable")},t(i.stats.is_available?"Online":"Offline"),3)])]),s("div",P,[e[8]||(e[8]=s("h2",null,"Availability",-1)),s("button",{onClick:e[0]||(e[0]=(...l)=>d.toggleAvailability&&d.toggleAvailability(...l)),class:v(i.rider.is_available?"btn-danger":"btn-success")},t(i.rider.is_available?"Go Offline":"Go Online"),3)]),s("div",R,[e[16]||(e[16]=s("h2",null,"Your Deliveries",-1)),i.deliveries.length===0?(n(),a("div",E,[...e[9]||(e[9]=[s("p",null,"You haven't been assigned any deliveries yet.",-1)])])):(n(),a("div",N,[(n(!0),a(g,null,c(i.deliveries,l=>(n(),a("div",{key:l.id,class:"delivery-card"},[s("div",O,[s("h3",null,"Delivery #"+t(l.tracking_number),1),s("span",{class:v(["status",l.status])},t(l.status),3)]),s("div",T,[s("p",null,[e[10]||(e[10]=s("strong",null,"Sender:",-1)),o(" "+t(l.sender.user.first_name)+" "+t(l.sender.user.last_name),1)]),s("p",null,[e[11]||(e[11]=s("strong",null,"Recipient:",-1)),o(" "+t(l.recipient_name),1)]),s("p",null,[e[12]||(e[12]=s("strong",null,"Pickup:",-1)),o(" "+t(l.pickup_address),1)]),s("p",null,[e[13]||(e[13]=s("strong",null,"Delivery:",-1)),o(" "+t(l.delivery_address),1)]),s("p",null,[e[14]||(e[14]=s("strong",null,"Estimated Delivery:",-1)),o(" "+t(l.estimated_delivery),1)]),l.payment?(n(),a("p",w,[e[15]||(e[15]=s("strong",null,"Fee:",-1)),o(" "+t(d.formatCurrency(l.delivery_fee)),1)])):u("",!0)])]))),128))]))])])):u("",!0)])])}const H=_(m,[["render",z],["__scopeId","data-v-5f94ee12"]]);export{H as default};
