import{r as e,b as C,s as R,e as d,f as s,k as c,D as w,F as x,K as B,I as h,h as t,w as r,g as I,O as q,C as _,E as k,G as P,u as E,o as u}from"./vendor-CbvXNS-i.js";import{useAdminAuthStore as T}from"./adminAuth-DjiH6aaA.js";import{_ as z}from"./index--w8yyAH4.js";const G={name:"AdminLayout",setup(){const v=E(),n=T(),m=e(!1),o=e(!1),g=e(!1),p=e(!1),a=e([]),l=e(0),y=e({}),b=e(!1),f=e({current_password:"",new_password:"",confirm_password:""}),S=C(()=>n.hasPermission("manage_users")),N=C(()=>n.hasPermission("manage_settings")),A=()=>{m.value=!m.value,localStorage.setItem("admin_sidebar_collapsed",m.value)},M=()=>{g.value=!1,v.push("/admin/profile")},F=async()=>{try{await n.logout(),v.push("/admin-login")}catch(i){console.error("Logout error:",i)}},D=async()=>{if(f.value.new_password!==f.value.confirm_password){alert("New passwords do not match");return}b.value=!0;try{await n.changePassword(f.value),p.value=!1,f.value={current_password:"",new_password:"",confirm_password:""},alert("Password changed successfully")}catch(i){alert("Failed to change password: "+i.message)}finally{b.value=!1}},L=i=>new Date(i).toLocaleString(),U=async()=>{try{const i=await n.api.get("/admin-api/dashboard/recent-activities?limit=5");a.value=i.data.activities||[],l.value=a.value.length}catch(i){console.error("Failed to load notifications:",i)}},V=async()=>{try{const i=await n.api.get("/admin-api/users/me/");y.value=i.data}catch(i){console.error("Failed to load admin profile:",i)}};return R(()=>{m.value=localStorage.getItem("admin_sidebar_collapsed")==="true",U(),V()}),{sidebarCollapsed:m,showNotifications:o,showProfileMenu:g,showChangePassword:p,notifications:a,unreadNotifications:l,adminProfile:y,passwordForm:f,changingPassword:b,canManageUsers:S,canManageSettings:N,toggleSidebar:A,viewProfile:M,logout:F,changePassword:D,formatDate:L}}},K={class:"admin-layout"},O={class:"admin-header"},j={class:"header-content"},H={class:"header-actions"},J={class:"notifications"},Q={key:0,class:"notification-badge"},W={key:0,class:"notification-dropdown"},X={class:"notification-list"},Y={class:"admin-profile"},Z=["src"],$={key:0,class:"profile-dropdown"},ss={class:"admin-body"},ns={class:"sidebar-nav"},os={class:"nav-section"},ls={class:"nav-section"},as={class:"nav-section"},is={key:0,class:"nav-section"},ts={key:1,class:"nav-section"},rs={class:"admin-main"},es={class:"main-content"},ds={class:"modal-header"},us={class:"modal-body"},ms={class:"form-group"},cs={class:"form-group"},fs={class:"form-group"},ws={class:"modal-actions"},vs=["disabled"];function gs(v,n,m,o,g,p){const a=I("router-link");return u(),d("div",K,[s("header",O,[s("div",j,[n[18]||(n[18]=s("div",{class:"logo"},[s("h1",null,"RiderApp Admin")],-1)),s("div",H,[s("div",J,[s("button",{class:"notification-btn",onClick:n[0]||(n[0]=l=>o.showNotifications=!o.showNotifications)},[n[14]||(n[14]=s("i",{class:"icon-bell"},null,-1)),o.unreadNotifications>0?(u(),d("span",Q,w(o.unreadNotifications),1)):c("",!0)]),o.showNotifications?(u(),d("div",W,[n[15]||(n[15]=s("h4",null,"Notifications",-1)),s("div",X,[(u(!0),d(x,null,B(o.notifications,l=>(u(),d("div",{key:l.id,class:"notification-item"},[s("p",null,w(l.message),1),s("small",null,w(o.formatDate(l.created_at)),1)]))),128))])])):c("",!0)]),s("div",Y,[s("button",{class:"profile-btn",onClick:n[1]||(n[1]=l=>o.showProfileMenu=!o.showProfileMenu)},[s("img",{src:o.adminProfile.avatar||"/default-avatar.png",alt:"Profile",class:"avatar"},null,8,Z),s("span",null,w(o.adminProfile.name||"Admin User"),1),n[16]||(n[16]=s("i",{class:"icon-chevron-down"},null,-1))]),o.showProfileMenu?(u(),d("div",$,[s("a",{href:"#",onClick:n[2]||(n[2]=(...l)=>o.viewProfile&&o.viewProfile(...l))},"View Profile"),s("a",{href:"#",onClick:n[3]||(n[3]=l=>o.showChangePassword=!0)},"Change Password"),n[17]||(n[17]=s("hr",null,null,-1)),s("a",{href:"#",onClick:n[4]||(n[4]=(...l)=>o.logout&&o.logout(...l))},"Logout")])):c("",!0)])])])]),s("div",ss,[s("aside",{class:h(["admin-sidebar",{"sidebar-collapsed":o.sidebarCollapsed}])},[s("nav",ns,[s("div",os,[n[20]||(n[20]=s("h3",null,"Main",-1)),s("ul",null,[s("li",null,[t(a,{to:"/admin",class:"nav-link"},{default:r(()=>[...n[19]||(n[19]=[s("i",{class:"icon-dashboard"},null,-1),s("span",null,"Dashboard",-1)])]),_:1})])])]),s("div",ls,[n[25]||(n[25]=s("h3",null,"Management",-1)),s("ul",null,[s("li",null,[t(a,{to:"/admin/customers",class:"nav-link"},{default:r(()=>[...n[21]||(n[21]=[s("i",{class:"icon-users"},null,-1),s("span",null,"Customers",-1)])]),_:1})]),s("li",null,[t(a,{to:"/admin/drivers",class:"nav-link"},{default:r(()=>[...n[22]||(n[22]=[s("i",{class:"icon-truck"},null,-1),s("span",null,"Drivers/Riders",-1)])]),_:1})]),s("li",null,[t(a,{to:"/admin/deliveries",class:"nav-link"},{default:r(()=>[...n[23]||(n[23]=[s("i",{class:"icon-package"},null,-1),s("span",null,"Deliveries",-1)])]),_:1})]),s("li",null,[t(a,{to:"/admin/routes",class:"nav-link"},{default:r(()=>[...n[24]||(n[24]=[s("i",{class:"icon-map"},null,-1),s("span",null,"Routes",-1)])]),_:1})])])]),s("div",as,[n[28]||(n[28]=s("h3",null,"Analytics",-1)),s("ul",null,[s("li",null,[t(a,{to:"/admin/reports",class:"nav-link"},{default:r(()=>[...n[26]||(n[26]=[s("i",{class:"icon-bar-chart"},null,-1),s("span",null,"Reports",-1)])]),_:1})]),s("li",null,[t(a,{to:"/admin/audit-logs",class:"nav-link"},{default:r(()=>[...n[27]||(n[27]=[s("i",{class:"icon-activity"},null,-1),s("span",null,"Audit Logs",-1)])]),_:1})])])]),o.canManageUsers?(u(),d("div",is,[n[32]||(n[32]=s("h3",null,"Administration",-1)),s("ul",null,[s("li",null,[t(a,{to:"/admin/users",class:"nav-link"},{default:r(()=>[...n[29]||(n[29]=[s("i",{class:"icon-user-cog"},null,-1),s("span",null,"Users",-1)])]),_:1})]),s("li",null,[t(a,{to:"/admin/roles",class:"nav-link"},{default:r(()=>[...n[30]||(n[30]=[s("i",{class:"icon-shield"},null,-1),s("span",null,"Roles & Permissions",-1)])]),_:1})]),s("li",null,[t(a,{to:"/admin/settings",class:"nav-link"},{default:r(()=>[...n[31]||(n[31]=[s("i",{class:"icon-settings"},null,-1),s("span",null,"System Settings",-1)])]),_:1})])])])):c("",!0),o.canManageSettings?(u(),d("div",ts,[n[35]||(n[35]=s("h3",null,"System",-1)),s("ul",null,[s("li",null,[t(a,{to:"/admin/templates",class:"nav-link"},{default:r(()=>[...n[33]||(n[33]=[s("i",{class:"icon-mail"},null,-1),s("span",null,"Templates",-1)])]),_:1})]),s("li",null,[t(a,{to:"/admin/backup",class:"nav-link"},{default:r(()=>[...n[34]||(n[34]=[s("i",{class:"icon-database"},null,-1),s("span",null,"Backup",-1)])]),_:1})])])])):c("",!0)]),s("button",{class:"sidebar-toggle",onClick:n[5]||(n[5]=(...l)=>o.toggleSidebar&&o.toggleSidebar(...l))},[s("i",{class:h(o.sidebarCollapsed?"icon-chevron-right":"icon-chevron-left")},null,2)])],2),s("main",rs,[s("div",es,[q(v.$slots,"default",{},void 0)])])]),o.showChangePassword?(u(),d("div",{key:0,class:"modal-overlay",onClick:n[13]||(n[13]=l=>o.showChangePassword=!1)},[s("div",{class:"modal",onClick:n[12]||(n[12]=_(()=>{},["stop"]))},[s("div",ds,[n[36]||(n[36]=s("h3",null,"Change Password",-1)),s("button",{onClick:n[6]||(n[6]=l=>o.showChangePassword=!1),class:"close-btn"},"Ã—")]),s("div",us,[s("form",{onSubmit:n[11]||(n[11]=_((...l)=>o.changePassword&&o.changePassword(...l),["prevent"]))},[s("div",ms,[n[37]||(n[37]=s("label",{for:"current-password"},"Current Password",-1)),k(s("input",{type:"password",id:"current-password","onUpdate:modelValue":n[7]||(n[7]=l=>o.passwordForm.current_password=l),required:""},null,512),[[P,o.passwordForm.current_password]])]),s("div",cs,[n[38]||(n[38]=s("label",{for:"new-password"},"New Password",-1)),k(s("input",{type:"password",id:"new-password","onUpdate:modelValue":n[8]||(n[8]=l=>o.passwordForm.new_password=l),required:""},null,512),[[P,o.passwordForm.new_password]])]),s("div",fs,[n[39]||(n[39]=s("label",{for:"confirm-password"},"Confirm New Password",-1)),k(s("input",{type:"password",id:"confirm-password","onUpdate:modelValue":n[9]||(n[9]=l=>o.passwordForm.confirm_password=l),required:""},null,512),[[P,o.passwordForm.confirm_password]])]),s("div",ws,[s("button",{type:"button",onClick:n[10]||(n[10]=l=>o.showChangePassword=!1),class:"btn btn-secondary"}," Cancel "),s("button",{type:"submit",class:"btn btn-primary",disabled:o.changingPassword},w(o.changingPassword?"Changing...":"Change Password"),9,vs)])],32)])])])):c("",!0)])}const ys=z(G,[["render",gs],["__scopeId","data-v-6e011269"]]);export{ys as A};
